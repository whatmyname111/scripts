<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞</title>
  <link rel="stylesheet" href="/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <!-- FingerprintJS -->
  <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>üîë –í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –Ω–∞ 24 —á–∞—Å–∞</h1>
    <div id="key" class="key-box">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <button id="copyBtn" class="btn" disabled>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á</button>
    <p class="desc">–ö–ª—é—á –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑. –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è ‚Äî 24 —á–∞—Å–∞.</p>
  </div>

  <footer class="footer">
    ¬© 2025, by: Tw3ch1k_scripts in Render.com
  </footer>

  <script>
    async function sendUserData() {
      const fp = await FingerprintJS.load();
      const result = await fp.get();
      const hwid = result.visitorId;
      const cookies = document.cookie;

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∫–ª—é—á–∞,
      // —Å–µ—Ä–≤–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, –∏ –≤–µ—Ä–Ω—ë—Ç –µ–≥–æ
      const response = await fetch('/api/save_user', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ cookies, hwid })
      });

      return await response.json();
    }

    async function displayKey() {
      const resSave = await sendUserData();

      const keyBox = document.getElementById('key');
      const copyBtn = document.getElementById('copyBtn');

      if (resSave.status === 'exists') {
        keyBox.innerText = resSave.key;
        alert(`–í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã.\n–í–∞—à –∫–ª—é—á: ${resSave.key}\n–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${resSave.registered_at}`);
      } else if (resSave.status === 'saved') {
        keyBox.innerText = resSave.key;
        alert(`–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞.\n–í–∞—à –∫–ª—é—á: ${resSave.key}\n–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${resSave.registered_at}`);
      } else {
        keyBox.innerText = '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏';
      }

      copyBtn.disabled = false;
    }

    document.getElementById('copyBtn').onclick = () => {
      const key = document.getElementById('key').innerText;
      navigator.clipboard.writeText(key).then(() => alert('–ö–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!'));
    };

    displayKey();
  </script>
</body>
</html>
